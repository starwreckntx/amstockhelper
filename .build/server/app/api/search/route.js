"use strict";(()=>{var e={};e.id=280,e.ids=[280],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},88245:(e,t,a)=>{a.r(t),a.d(t,{originalPathname:()=>k,patchFetch:()=>T,requestAsyncStorage:()=>h,routeModule:()=>f,serverHooks:()=>D,staticGenerationAsyncStorage:()=>b});var n={};a.r(n),a.d(n,{POST:()=>m,dynamic:()=>d});var i=a(79182),r=a(72007),o=a(56719),s=a(93442),c=a(35970);let d="force-dynamic";async function m(e){try{let{searchType:t,searchTerm:a,filters:n}=await e.json(),i=[];switch(t){case"casting-runs":i=await u(a,n);break;case"quality-inspections":i=await p(a,n);break;case"maintenance-records":i=await l(a,n);break;case"defect-records":i=await y(a,n);break;case"heat-numbers":i=await w(a,n);break;case"work-orders":i=await v(a,n);break;default:i=[]}return s.NextResponse.json(i)}catch(e){return console.error("Search error:",e),s.NextResponse.json({error:"Search failed"},{status:500})}}async function u(e,t){let a={};return e&&(a.OR=[{workOrder:{workOrderNumber:{contains:e,mode:"insensitive"}}},{operatorId:{contains:e,mode:"insensitive"}},{notes:{contains:e,mode:"insensitive"}},{packageInfo:{contains:e,mode:"insensitive"}}]),t.workOrderId&&(a.workOrderId=t.workOrderId),t.heatNumber&&(a.heatNumber={heatNumber:t.heatNumber}),t.operatorId&&(a.operatorId={contains:t.operatorId,mode:"insensitive"}),(t.dateFrom||t.dateTo)&&(a.castingDate={},t.dateFrom&&(a.castingDate.gte=new Date(t.dateFrom)),t.dateTo&&(a.castingDate.lte=new Date(t.dateTo))),(t.rpmMin||t.rpmMax)&&(a.actualRpm={},t.rpmMin&&(a.actualRpm.gte=parseInt(t.rpmMin)),t.rpmMax&&(a.actualRpm.lte=parseInt(t.rpmMax))),await c._.castingRun.findMany({where:a,include:{workOrder:{select:{workOrderNumber:!0}},heatNumber:{select:{heatNumber:!0,alloyType:{select:{alloyName:!0}}}},moldSpecification:{select:{moldType:!0,castingSize:!0}}},orderBy:{castingDate:"desc"},take:100})}async function p(e,t){let a={};return e&&(a.OR=[{inspectorId:{contains:e,mode:"insensitive"}},{notes:{contains:e,mode:"insensitive"}},{correctiveActions:{contains:e,mode:"insensitive"}}]),t.inspectorId&&(a.inspectorId={contains:t.inspectorId,mode:"insensitive"}),t.qualityRating&&(a.overallRating=parseInt(t.qualityRating)),t.passFailStatus&&(a.passFailStatus=t.passFailStatus),(t.dateFrom||t.dateTo)&&(a.inspectionDate={},t.dateFrom&&(a.inspectionDate.gte=new Date(t.dateFrom)),t.dateTo&&(a.inspectionDate.lte=new Date(t.dateTo))),await c._.qualityInspection.findMany({where:a,include:{castingRun:{select:{workOrder:{select:{workOrderNumber:!0}},heatNumber:{select:{heatNumber:!0}}}}},orderBy:{inspectionDate:"desc"},take:100})}async function l(e,t){let a={};return e&&(a.OR=[{technicianId:{contains:e,mode:"insensitive"}},{maintenancePerformed:{contains:e,mode:"insensitive"}},{notes:{contains:e,mode:"insensitive"}}]),t.equipmentId&&(a.spinnerId=t.equipmentId),t.maintenanceType&&(a.maintenanceType=t.maintenanceType),t.technicianId&&(a.technicianId={contains:t.technicianId,mode:"insensitive"}),(t.dateFrom||t.dateTo)&&(a.maintenanceDate={},t.dateFrom&&(a.maintenanceDate.gte=new Date(t.dateFrom)),t.dateTo&&(a.maintenanceDate.lte=new Date(t.dateTo))),await c._.maintenanceRecord.findMany({where:a,include:{spinnerEquipment:{select:{equipmentModel:!0}}},orderBy:{maintenanceDate:"desc"},take:100})}async function y(e,t){let a={};return e&&(a.OR=[{defectType:{contains:e,mode:"insensitive"}},{defectDescription:{contains:e,mode:"insensitive"}},{probableCause:{contains:e,mode:"insensitive"}},{correctiveAction:{contains:e,mode:"insensitive"}}]),t.defectType&&(a.defectType=t.defectType),t.defectSeverity&&(a.defectSeverity=t.defectSeverity),await c._.defectRecord.findMany({where:a,include:{castingRun:{select:{workOrder:{select:{workOrderNumber:!0}},heatNumber:{select:{heatNumber:!0}}}},qualityInspection:{select:{inspectorId:!0,inspectionDate:!0}}},orderBy:{id:"desc"},take:100})}async function w(e,t){let a={};return e&&(a.OR=[{heatNumber:{contains:e,mode:"insensitive"}},{furnaceId:{contains:e,mode:"insensitive"}},{qualityCertification:{contains:e,mode:"insensitive"}}]),t.alloyType&&(a.alloyId=t.alloyType),(t.dateFrom||t.dateTo)&&(a.meltDate={},t.dateFrom&&(a.meltDate.gte=new Date(t.dateFrom)),t.dateTo&&(a.meltDate.lte=new Date(t.dateTo))),await c._.heatNumber.findMany({where:a,include:{alloyType:{select:{alloyName:!0}}},orderBy:{heatNumber:"desc"},take:100})}async function v(e,t){let a={};return e&&(a.OR=[{workOrderNumber:{contains:e,mode:"insensitive"}},{partSpecification:{contains:e,mode:"insensitive"}}]),t.priorityLevel&&(a.priorityLevel=t.priorityLevel),t.status&&(a.status=t.status),(t.dateFrom||t.dateTo)&&(a.orderDate={},t.dateFrom&&(a.orderDate.gte=new Date(t.dateFrom)),t.dateTo&&(a.orderDate.lte=new Date(t.dateTo))),await c._.workOrder.findMany({where:a,orderBy:{createdDate:"desc"},take:100})}let f=new i.AppRouteRouteModule({definition:{kind:r.x.APP_ROUTE,page:"/api/search/route",pathname:"/api/search",filename:"route",bundlePath:"app/api/search/route"},resolvedPagePath:"/home/ubuntu/american_spincast_foundry/app/app/api/search/route.ts",nextConfigOutput:"",userland:n}),{requestAsyncStorage:h,staticGenerationAsyncStorage:b,serverHooks:D}=f,k="/api/search/route";function T(){return(0,o.patchFetch)({serverHooks:D,staticGenerationAsyncStorage:b})}},35970:(e,t,a)=>{a.d(t,{_:()=>i});let n=require("@prisma/client"),i=globalThis.prisma??new n.PrismaClient}};var t=require("../../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),n=t.X(0,[372,609],()=>a(88245));module.exports=n})();