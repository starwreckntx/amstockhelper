"use strict";(()=>{var e={};e.id=550,e.ids=[550],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},42738:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>D,patchFetch:()=>g,requestAsyncStorage:()=>d,routeModule:()=>u,serverHooks:()=>m,staticGenerationAsyncStorage:()=>l});var a={};r.r(a),r.d(a,{POST:()=>p,dynamic:()=>c});var n=r(79182),i=r(72007),o=r(56719),s=r(93442);let c="force-dynamic";async function p(e){try{let{searchType:t,results:r}=await e.json();if(!r||0===r.length)return s.NextResponse.json({error:"No results to export"},{status:400});let a="",n=[];switch(t){case"casting-runs":n=["Casting Run ID","Work Order","Heat Number","Alloy Type","Casting Date","Operator ID","RPM Setting","Actual RPM","Pour Temperature","Casting Weight (kg)","Status","Notes"],a=r.map(e=>[e.id,e.workOrder?.workOrderNumber||"",e.heatNumber?.heatNumber||"",e.heatNumber?.alloyType?.alloyName||"",new Date(e.castingDate).toLocaleDateString(),e.operatorId||"",e.rpmSetting||"",e.actualRpm||"",e.pourTemperature||"",e.castingWeightKg||"",e.status||"",e.notes||""]).map(e=>e.join(",")).join("\n");break;case"quality-inspections":n=["Inspection ID","Work Order","Inspection Date","Inspector ID","Inspection Type","Overall Rating","Surface Rating","Internal Rating","Pass/Fail Status","Corrective Actions","Notes"],a=r.map(e=>[e.id,e.castingRun?.workOrder?.workOrderNumber||"",new Date(e.inspectionDate).toLocaleDateString(),e.inspectorId||"",e.inspectionType||"",e.overallRating||"",e.surfaceQualityRating||"",e.internalQualityRating||"",e.passFailStatus||"",e.correctiveActions||"",e.notes||""]).map(e=>e.join(",")).join("\n");break;case"maintenance-records":n=["Maintenance ID","Equipment ID","Equipment Model","Maintenance Date","Maintenance Type","Technician ID","Current RPM","Target RPM","Vibration Level","Temperature Reading","Cost","Condition After Service","Notes"],a=r.map(e=>[e.id,e.spinnerId||"",e.spinnerEquipment?.equipmentModel||"",new Date(e.maintenanceDate).toLocaleDateString(),e.maintenanceType||"",e.technicianId||"",e.currentRpm||"",e.targetRpm||"",e.vibrationLevel||"",e.temperatureReading||"",e.cost||"",e.conditionAfterService||"",e.notes||""]).map(e=>e.join(",")).join("\n");break;case"defect-records":n=["Defect ID","Work Order","Heat Number","Defect Type","Severity","Location","Description","Probable Cause","Corrective Action","Cost Impact","Status"],a=r.map(e=>[e.id,e.castingRun?.workOrder?.workOrderNumber||"",e.castingRun?.heatNumber?.heatNumber||"",e.defectType||"",e.defectSeverity||"",e.defectLocation||"",e.defectDescription||"",e.probableCause||"",e.correctiveAction||"",e.costImpact||"",e.status||""]).map(e=>e.join(",")).join("\n");break;case"heat-numbers":n=["Heat ID","Heat Number","Alloy Type","Batch Size (kg)","Melt Date","Furnace ID","Quality Certification","Status"],a=r.map(e=>[e.id,e.heatNumber||"",e.alloyType?.alloyName||"",e.batchSizeKg||"",new Date(e.meltDate).toLocaleDateString(),e.furnaceId||"",e.qualityCertification||"",e.status||""]).map(e=>e.join(",")).join("\n");break;case"work-orders":n=["Work Order ID","Work Order Number","Customer ID","Part Specification","Quantity Ordered","Order Date","Due Date","Priority Level","Status"],a=r.map(e=>[e.id,e.workOrderNumber||"",e.customerId||"",e.partSpecification||"",e.quantityOrdered||"",new Date(e.orderDate).toLocaleDateString(),e.dueDate?new Date(e.dueDate).toLocaleDateString():"",e.priorityLevel||"",e.status||""]).map(e=>e.join(",")).join("\n");break;default:return s.NextResponse.json({error:"Invalid search type"},{status:400})}let i=n.join(",")+"\n"+a;return new s.NextResponse(i,{status:200,headers:{"Content-Type":"text/csv","Content-Disposition":`attachment; filename="foundry-${t}-export.csv"`}})}catch(e){return console.error("Export error:",e),s.NextResponse.json({error:"Export failed"},{status:500})}}let u=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/search/export/route",pathname:"/api/search/export",filename:"route",bundlePath:"app/api/search/export/route"},resolvedPagePath:"/home/ubuntu/american_spincast_foundry/app/app/api/search/export/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:m}=u,D="/api/search/export/route";function g(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:l})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[372,609],()=>r(42738));module.exports=a})();